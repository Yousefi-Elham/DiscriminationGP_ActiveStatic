as.numeric(row.names(xstart))
  [1]    51   508   557   153   610  5571   245  1531  5081  5572  1532  5573  6101   511  5082  2451  1533  5574   144  5575  1534  6102
 [23]  2452  1441  2453  1535  6103  1442   512  5576  5083  2454   513  1443  2455  1444   142  2456  1445  5084  1421  2457  1422    49
 [45]  5577  6104  1536  1446  2458   514  5578  5085  1423  2459   491  1447  1537  6105   515  5579  1424   492 24510   516  5086   493
 [67]   517 55710 24511  5087  1448   518  1425   494 55711   519  5088   495 55712   496 24512  1538  6106  1449  5110 55713 24513  5089
 [89]  1426   497 55714  1539 14410  5111 24514 50810   498 14411 55715  5112  1427 50811 24515   499  6107 15310 24516 55716  5113 14412
[111] 50812 24517  4910 55717  1428 15311  6108  5114 14413 55718 24518 50813  5115 14414 15312 55719 24519  4911  6109 50814  5116  1429
[133] 24520 55720  4912 15313 14415 50815 24521  5117 55721 14416 61010 15314 24522 55722  5118 14210  4913 50816  4914  5119 24523 55723
[155] 14417 50817  5120 14211  4915 55724 24524 50818 15315 61011 14418  5121 24525 55725  4916 50819 14212  5122 14419 55726 15316 24526
[177] 61012  4917 50820 24527  5123 55727 14420 15317 61013 24528 55728 15318 14421  5124 14213 50821  4918 24529 55729  5125 14422 50822
[199] 24530 61014
> nrow(xstart)
[1] 200
> nrow(xstart)-n1 
[1] 196
> nleft
[1] 196
> length(CRIT.vec)
[1] 200
> CRIT.vec <- CRIT.vec[1:nrow(xstart)]
> length(CRIT.vec)
[1] 200
> CRIT.vec
  [1] 2.347536e-12 2.347536e-12 2.347536e-12 2.347536e-12 1.394195e-02 2.031404e-02 2.792275e-02 3.649092e-02 4.630565e-02 5.728523e-02
 [11] 6.955379e-02 8.288749e-02 9.737033e-02 1.127745e-01 1.295647e-01 1.477501e-01 1.669935e-01 1.871672e-01 2.084478e-01 2.307963e-01
 [21] 2.545602e-01 2.797291e-01 3.058454e-01 3.330711e-01 3.614025e-01 3.908622e-01 4.215995e-01 4.532654e-01 4.862879e-01 5.206123e-01
 [31] 5.558833e-01 5.923424e-01 6.299227e-01 6.685045e-01 7.085990e-01 7.494825e-01 7.929011e-01 8.362657e-01 8.808008e-01 9.266778e-01
 [41] 9.734815e-01 1.021585e+00 1.070639e+00 1.121177e+00 1.173146e+00 1.226080e+00 1.280160e+00 1.335075e+00 1.393557e+00 1.451257e+00
 [51] 1.511014e+00 1.570889e+00 1.632101e+00 1.694208e+00 1.757648e+00 1.822397e+00 1.887946e+00 1.954698e+00 2.022821e+00 2.092005e+00
 [61] 2.163195e+00 2.235007e+00 2.307793e+00 2.381482e+00 2.456425e+00 2.532552e+00 2.610199e+00 2.688660e+00 2.768397e+00 2.849640e+00
 [71] 2.932026e+00 3.015192e+00 3.099528e+00 3.185000e+00 3.271556e+00 3.359595e+00 3.448665e+00 3.538691e+00 3.631133e+00 3.723602e+00
 [81] 3.818070e+00 3.912978e+00 4.009291e+00 4.106281e+00 4.204723e+00 4.304330e+00 4.404791e+00 4.506665e+00 4.609818e+00 4.714194e+00
 [91] 4.819528e+00 4.926220e+00 5.033508e+00 5.142283e+00 5.252951e+00 5.364180e+00 5.476671e+00 5.590492e+00 5.704907e+00 5.820632e+00
[101] 5.937540e+00 6.055688e+00 6.175092e+00 6.295834e+00 6.417550e+00 6.540380e+00 6.664279e+00 6.789476e+00 6.915985e+00 7.043334e+00
[111] 7.172196e+00 7.302171e+00 7.432786e+00 7.564759e+00 7.698198e+00 7.832708e+00 7.968377e+00 8.105218e+00 8.243108e+00 8.382288e+00
[121] 8.522698e+00 8.664098e+00 8.806993e+00 8.950787e+00 9.095633e+00 9.241675e+00 9.388995e+00 9.537325e+00 9.686988e+00 9.837996e+00
[131] 9.989921e+00 1.014292e+01 1.029718e+01 1.045248e+01 1.060910e+01 1.076715e+01 1.092600e+01 1.108616e+01 1.124742e+01 1.140972e+01
[141] 1.157334e+01 1.173837e+01 1.190419e+01 1.207129e+01 1.223954e+01 1.240868e+01 1.257920e+01 1.275094e+01 1.292391e+01 1.310028e+01
[151] 1.327575e+01 1.345206e+01 1.362949e+01 1.380830e+01 1.398814e+01 1.416951e+01 1.435172e+01 1.453497e+01 1.471932e+01 1.490513e+01
[161] 1.509191e+01 1.528020e+01 1.546931e+01 1.565990e+01 1.585159e+01 1.604435e+01 1.623813e+01 1.643330e+01 1.662941e+01 1.682673e+01
[171] 1.702528e+01 1.722473e+01 1.742548e+01 1.762764e+01 1.783101e+01 1.803566e+01 1.824137e+01 1.844778e+01 1.865541e+01 1.886455e+01
[181] 1.907463e+01 1.928612e+01 1.949881e+01 1.971260e+01 1.992734e+01 2.014331e+01 2.036029e+01 2.057862e+01 2.079819e+01 2.101890e+01
[191] 2.124079e+01 2.146380e+01 2.168788e+01 2.191334e+01 2.214019e+01 2.236759e+01 2.259623e+01 2.282640e+01 2.305728e+01 2.328956e+01
> xstart
      Var1 Var2
51    10.0  0.0
508    9.6  1.8
557    9.2  2.0
153   10.0  0.4
610    9.6  2.2
5571   9.2  2.0
245    8.0  0.8
1531  10.0  0.4
5081   9.6  1.8
5572   9.2  2.0
1532  10.0  0.4
5573   9.2  2.0
6101   9.6  2.2
511   10.0  0.0
5082   9.6  1.8
2451   8.0  0.8
1533  10.0  0.4
5574   9.2  2.0
144    8.2  0.4
5575   9.2  2.0
1534  10.0  0.4
6102   9.6  2.2
2452   8.0  0.8
1441   8.2  0.4
2453   8.0  0.8
1535  10.0  0.4
6103   9.6  2.2
1442   8.2  0.4
512   10.0  0.0
5576   9.2  2.0
5083   9.6  1.8
2454   8.0  0.8
513   10.0  0.0
1443   8.2  0.4
2455   8.0  0.8
1444   8.2  0.4
142    7.8  0.4
2456   8.0  0.8
1445   8.2  0.4
5084   9.6  1.8
1421   7.8  0.4
2457   8.0  0.8
1422   7.8  0.4
49     9.6  0.0
5577   9.2  2.0
6104   9.6  2.2
1536  10.0  0.4
1446   8.2  0.4
2458   8.0  0.8
514   10.0  0.0
5578   9.2  2.0
5085   9.6  1.8
1423   7.8  0.4
2459   8.0  0.8
491    9.6  0.0
1447   8.2  0.4
1537  10.0  0.4
6105   9.6  2.2
515   10.0  0.0
5579   9.2  2.0
1424   7.8  0.4
492    9.6  0.0
24510  8.0  0.8
516   10.0  0.0
5086   9.6  1.8
493    9.6  0.0
517   10.0  0.0
55710  9.2  2.0
24511  8.0  0.8
5087   9.6  1.8
1448   8.2  0.4
518   10.0  0.0
1425   7.8  0.4
494    9.6  0.0
55711  9.2  2.0
519   10.0  0.0
5088   9.6  1.8
495    9.6  0.0
55712  9.2  2.0
496    9.6  0.0
24512  8.0  0.8
1538  10.0  0.4
6106   9.6  2.2
1449   8.2  0.4
5110  10.0  0.0
55713  9.2  2.0
24513  8.0  0.8
5089   9.6  1.8
1426   7.8  0.4
497    9.6  0.0
55714  9.2  2.0
1539  10.0  0.4
14410  8.2  0.4
5111  10.0  0.0
24514  8.0  0.8
50810  9.6  1.8
498    9.6  0.0
14411  8.2  0.4
55715  9.2  2.0
5112  10.0  0.0
1427   7.8  0.4
50811  9.6  1.8
24515  8.0  0.8
499    9.6  0.0
6107   9.6  2.2
15310 10.0  0.4
24516  8.0  0.8
55716  9.2  2.0
5113  10.0  0.0
14412  8.2  0.4
50812  9.6  1.8
24517  8.0  0.8
4910   9.6  0.0
55717  9.2  2.0
1428   7.8  0.4
15311 10.0  0.4
6108   9.6  2.2
5114  10.0  0.0
14413  8.2  0.4
55718  9.2  2.0
24518  8.0  0.8
50813  9.6  1.8
5115  10.0  0.0
14414  8.2  0.4
15312 10.0  0.4
55719  9.2  2.0
24519  8.0  0.8
4911   9.6  0.0
6109   9.6  2.2
50814  9.6  1.8
5116  10.0  0.0
1429   7.8  0.4
24520  8.0  0.8
55720  9.2  2.0
4912   9.6  0.0
15313 10.0  0.4
14415  8.2  0.4
50815  9.6  1.8
24521  8.0  0.8
5117  10.0  0.0
55721  9.2  2.0
14416  8.2  0.4
61010  9.6  2.2
15314 10.0  0.4
24522  8.0  0.8
55722  9.2  2.0
5118  10.0  0.0
14210  7.8  0.4
4913   9.6  0.0
50816  9.6  1.8
4914   9.6  0.0
5119  10.0  0.0
24523  8.0  0.8
55723  9.2  2.0
14417  8.2  0.4
50817  9.6  1.8
5120  10.0  0.0
14211  7.8  0.4
4915   9.6  0.0
55724  9.2  2.0
24524  8.0  0.8
50818  9.6  1.8
15315 10.0  0.4
61011  9.6  2.2
14418  8.2  0.4
5121  10.0  0.0
24525  8.0  0.8
55725  9.2  2.0
4916   9.6  0.0
50819  9.6  1.8
14212  7.8  0.4
5122  10.0  0.0
14419  8.2  0.4
55726  9.2  2.0
15316 10.0  0.4
24526  8.0  0.8
61012  9.6  2.2
4917   9.6  0.0
50820  9.6  1.8
24527  8.0  0.8
5123  10.0  0.0
55727  9.2  2.0
14420  8.2  0.4
15317 10.0  0.4
61013  9.6  2.2
24528  8.0  0.8
55728  9.2  2.0
15318 10.0  0.4
14421  8.2  0.4
5124  10.0  0.0
14213  7.8  0.4
50821  9.6  1.8
4918   9.6  0.0
24529  8.0  0.8
55729  9.2  2.0
5125  10.0  0.0
14422  8.2  0.4
50822  9.6  1.8
24530  8.0  0.8
61014  9.6  2.2
> #####################################################################################################
> nrow(xstart)
[1] 200
> design1.uniq <- uniquecombs(xstart)
> counter1=attr(design1.uniq,"index")
> counter2=unique(sort(counter1))
> replic1 <- replic2 <- numeric(nrow(design1.uniq))
> counter1
  [1] 1 2 3 4 5 3 6 4 2 3 4 3 5 1 2 6 4 3 7 3 4 5 6 7 6 4 5 7 1 3 2 6 1 7 6 7 8 6 7 2 8 6 8 9 3 5 4 7 6 1 3 2 8 6 9 7 4 5 1 3 8 9 6 1 2 9 1
 [68] 3 6 2 7 1 8 9 3 1 2 9 3 9 6 4 5 7 1 3 6 2 8 9 3 4 7 1 6 2 9 7 3 1 8 2 6 9 5 4 6 3 1 7 2 6 9 3 8 4 5 1 7 3 6 2 1 7 4 3 6 9 5 2 1 8 6 3
[135] 9 4 7 2 6 1 3 7 5 4 6 3 1 8 9 2 9 1 6 3 7 2 1 8 9 3 6 2 4 5 7 1 6 3 9 2 8 1 7 3 4 6 5 9 2 6 1 3 7 4 5 6 3 4 7 1 8 2 9 6 3 1 7 2 6 5
> counter2
[1] 1 2 3 4 5 6 7 8 9
> #----------------------------------------------------------------
> #counter <- counter2 <- numeric(length(design1.uniq))
> for(z in 1:length(counter2)){
+   x.replic <- which(counter1==counter2[z])
+   replic1[z] <- length(x.replic)
+   replic2[z] <- length(x.replic)/nrow(xstart)
+   
+ }
> design.opt <- cbind(design1.uniq,replic1,replic2)
> design.opt
    Var1 Var2 replic1 replic2
51  10.0  0.0      26   0.130
508  9.6  1.8      23   0.115
557  9.2  2.0      30   0.150
153 10.0  0.4      19   0.095
610  9.6  2.2      15   0.075
245  8.0  0.8      31   0.155
144  8.2  0.4      23   0.115
142  7.8  0.4      14   0.070
49   9.6  0.0      19   0.095
> sum(design.opt[,3])
[1] 200
> sum(design.opt[,4])
[1] 1