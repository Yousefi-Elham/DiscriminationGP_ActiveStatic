(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7791,        234]
NotebookOptionsPosition[      6992,        214]
NotebookOutlinePosition[      7336,        229]
CellTagsIndexPosition[      7293,        226]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"theta1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta2", "=", "1.07"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.861340105875696*^9, 3.86134011373648*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"5ba288f8-8b10-4f6f-87c7-d4a2c8ec1840"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edis", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1", "-", "x3"}], ")"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x2", "-", "x4"}], ")"}], "^", "2"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ker1", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", " ", 
  RowBox[{"sigma2", "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "*", 
      RowBox[{"edis", "[", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "*", 
      "theta1"}]}], ")"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "3", "]"}]}], "*", 
     RowBox[{"edis", "[", 
      RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "*", "theta1"}],
     "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.861340129227453*^9, 3.8613401335474186`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"d01ed2d7-102a-4f39-8b3b-963bf2525597"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ker2", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", " ", 
   RowBox[{"sigma2", "*", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", "5", "]"}], "*", 
       RowBox[{"edis", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "*", 
       "theta2"}], " ", "+", " ", 
      RowBox[{"5", "*", 
       RowBox[{
        RowBox[{"edis", "[", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "^", "2"}], 
       "*", 
       RowBox[{
        RowBox[{"theta2", "^", "2"}], "/", "3"}]}]}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "5", "]"}]}], "*", 
      RowBox[{"edis", "[", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "*", 
      "theta2"}], "]"}]}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.861340141940109*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"cfc9eff3-7a1f-4836-9913-185d642127be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"derf", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "a_", ",", "b_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"ker1", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], "-", 
       RowBox[{"ker2", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}]}], "]"}], "^", 
     "2"}], "*", " ", "a", "*", "b"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.8613401572112684`*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"9633e296-9edc-4a4d-a2f4-ed74a208443c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"derf", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "a_", ",", "b_"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"a", "+", "b"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "0", ",", "10"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8613402048709035`*^9, 3.861340205266862*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"b3380b71-b0c6-4995-8790-6131459fdfdc"],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             SqrtBox["3"]}], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1_", "-", "x3_"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x2_", "-", "x4_"}], ")"}], "2"]}]]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SqrtBox["3"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1_", "-", "x3_"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x2_", "-", "x4_"}], ")"}], "2"]}]]}]}], ")"}]}], 
         "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2.3925927359247754`"}], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1_", "-", "x3_"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x2_", "-", "x4_"}], ")"}], "2"]}]]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2.3925927359247754`", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1_", "-", "x3_"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x2_", "-", "x4_"}], ")"}], "2"]}]]}], "+", 
            RowBox[{"1.9081666666666666`", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1_", "-", "x3_"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x2_", "-", "x4_"}], ")"}], "2"]}], ")"}]}]}], 
           ")"}]}]}], "]"}], "2"], " ", "a_", " ", "b_"}], ",", 
     RowBox[{
      RowBox[{"a", "+", "b"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "0", ",", "10"}], 
    "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8613402782407103`*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"f560a934-bb30-4ed9-ab99-6a9aa9e92050"]
}, Open  ]]
},
WindowSize->{759, 833},
WindowMargins->{{Automatic, 334}, {134, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 371, 9, 67, "Input",ExpressionUUID->"5ba288f8-8b10-4f6f-87c7-d4a2c8ec1840"],
Cell[932, 31, 1146, 33, 105, "Input",ExpressionUUID->"d01ed2d7-102a-4f39-8b3b-963bf2525597"],
Cell[2081, 66, 1037, 29, 86, "Input",ExpressionUUID->"cfc9eff3-7a1f-4836-9913-185d642127be"],
Cell[3121, 97, 633, 17, 48, "Input",ExpressionUUID->"9633e296-9edc-4a4d-a2f4-ed74a208443c"],
Cell[CellGroupData[{
Cell[3779, 118, 569, 16, 28, "Input",ExpressionUUID->"b3380b71-b0c6-4995-8790-6131459fdfdc"],
Cell[4351, 136, 2625, 75, 185, "Output",ExpressionUUID->"f560a934-bb30-4ed9-ab99-6a9aa9e92050"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

