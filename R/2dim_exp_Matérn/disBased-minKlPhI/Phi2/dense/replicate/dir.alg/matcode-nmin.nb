(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13656,        382]
NotebookOptionsPosition[     10941,        330]
NotebookOutlinePosition[     11285,        345]
CellTagsIndexPosition[     11242,        342]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"theta1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta2", "=", "1.07"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2", "=", "1"}], ";"}]}], "Input",ExpressionUUID->"cda7e3a5-\
1c44-4a33-80cd-ed9376c37470"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matp", "[", 
   RowBox[{"x1_", ",", "y1_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "y1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "y1"}], "+", "10"}], ",", 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "10"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8618700456469507`*^9, 3.8618700457825584`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"2a421fa8-3e0e-4b2f-9540-1d7826ad403b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eucd1", "[", 
   RowBox[{"x1_", ",", "y1_"}], "]"}], ":=", 
  RowBox[{"Outer", "[", 
   RowBox[{"EuclideanDistance", ",", 
    RowBox[{"matp", "[", 
     RowBox[{"x1", ",", "y1"}], "]"}], ",", 
    RowBox[{"matp", "[", 
     RowBox[{"x1", ",", "y1"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8618700640308704`*^9, 3.861870075208909*^9}, 
   3.8618705572815733`*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"10fe2c57-a59a-4d81-978b-bfede4000eaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eucd1", "[", 
  RowBox[{"9.2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.861870572311039*^9, 3.861870594157658*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"b72eefc6-95dc-4f58-a57d-06874eca58eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "2.154065922853802`", ",", "2.154065922853802`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.154065922853802`", ",", "0.`", ",", "1.6970562748477132`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.154065922853802`", ",", "1.6970562748477132`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8618705982044673`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"b3439cd8-93dd-4bb9-8d04-3fd7a3265112"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"kernel1", "[", 
   RowBox[{"x1_", ",", "y1_"}], "]"}], ":=", " ", 
  RowBox[{"sigma2", "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "*", 
      RowBox[{"eucd1", "[", 
       RowBox[{"x1", ",", "y1"}], "]"}], "*", "theta1"}]}], ")"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "3", "]"}]}], "*", 
     RowBox[{"eucd1", "[", 
      RowBox[{"x1", ",", "y1"}], "]"}], "*", "theta1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.861870781478441*^9, 3.8618708356393785`*^9}, {
  3.861870904753023*^9, 3.8618709202021303`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"b9532cab-c899-4472-8667-68ca616b19c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kernel2", "[", 
   RowBox[{"x1_", ",", "y1_"}], "]"}], ":=", 
  RowBox[{"sigma2", "*", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"Sqrt", "[", "5", "]"}], "*", 
      RowBox[{"eucd1", "[", 
       RowBox[{"x1", ",", "y1"}], "]"}], "*", "theta2"}], " ", "+", " ", 
     RowBox[{"5", "*", 
      RowBox[{
       RowBox[{"eucd1", "[", 
        RowBox[{"x1", ",", "y1"}], "]"}], "^", "2"}], "*", 
      RowBox[{
       RowBox[{"theta2", "^", "2"}], "/", "3"}]}]}], ")"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "5", "]"}]}], "*", 
     RowBox[{"eucd1", "[", 
      RowBox[{"x1", ",", "y1"}], "]"}], "*", "theta2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8618709433703747`*^9, 3.8618709865003033`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"9cf3adeb-81f7-4a1e-8de7-d68cfc43500c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kernel1", "[", 
  RowBox[{"9.2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.86187107173809*^9, 3.8618710806864276`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"00c01532-6e72-41bb-9c81-8c01c01a9c53"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0.11340097945624733`", ",", "0.11340097945624733`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11340097945624733`", ",", "1.`", ",", "0.20838615867889432`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11340097945624733`", ",", "0.20838615867889432`", ",", "1.`"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8618710822856646`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"796f7df4-c36c-471b-b7d9-e6994efe9250"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kernel2", "[", 
  RowBox[{"9.2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8618713536567845`*^9, 3.8618713615846615`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"078c7367-87fd-460c-8a17-82a9c4824f41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.08670537896646272`", ",", "0.08670537896646272`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08670537896646272`", ",", "1.`", ",", "0.18201229536505273`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08670537896646272`", ",", "0.18201229536505273`", ",", "1.`"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8618713699029646`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"10cf7da7-775f-483b-b52c-e4efbd49150f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"derf", "[", 
   RowBox[{"x1_", ",", "y1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"kernel1", "[", 
      RowBox[{"x1", ",", "y1"}], "]"}], "-", 
     RowBox[{"kernel2", "[", 
      RowBox[{"x1", ",", "y1"}], "]"}]}], "]"}], "^", "2"}]}]], "Input",
 CellChangeTimes->{{3.8618714043952355`*^9, 3.8618714840849066`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"9da8d941-db66-4589-a7e6-077176d0d6bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"derf", "[", 
  RowBox[{"9.2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.861871507575783*^9, 3.861871516069811*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"8ee07437-ce36-47f9-8659-0aa8cb7d0edb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.0007126550855101886`", ",", "0.0007126550855101886`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0007126550855101886`", ",", "0.`", ",", "0.0006955806660971992`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0007126550855101886`", ",", "0.0006955806660971992`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.861871518109864*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"c8c95f9e-6fba-44d7-bb6b-eabdfcb94473"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"weightf", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}], "}"}], "]"}], ".", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "b"}], "}"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfun", "[", 
   RowBox[{"x1_", ",", "y1_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"derf", "[", 
    RowBox[{"x1", ",", "y1"}], "]"}], ".", 
   RowBox[{"weightf", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8618725449112916`*^9, 3.8618725679926543`*^9}, {
  3.8618726137817945`*^9, 3.8618726434793615`*^9}, {3.8618726769503703`*^9, 
  3.8618726836039643`*^9}, {3.8618730202107697`*^9, 3.861873023442176*^9}, {
  3.861873158685088*^9, 3.8618732423352933`*^9}, {3.8618733849566755`*^9, 
  3.8618734072849207`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"d479c06d-4d6e-47ef-bd27-37aaa25e18a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dfun", "[", 
  RowBox[{"9.2", ",", "2", ",", "0.2", ",", "0.4"}], "]"}]], "Input",
 CellChangeTimes->{{3.8618734196153955`*^9, 3.8618734507170267`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"6864e6a5-bf02-44d7-971f-ec0a7c88b573"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.0001140248136816302`", ",", "0.0002280496273632604`", ",", 
     "0.0002280496273632604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000841526567081835`", ",", "0.000168305313416367`", ",", 
     "0.000168305313416367`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000841526567081835`", ",", "0.000168305313416367`", ",", 
     "0.000168305313416367`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.861873458953963*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"a16a2ea8-264b-40fe-a548-e394c022a746"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"dfun", "[", 
   RowBox[{"9.2", ",", "2", ",", "0.2", ",", "0.4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8618736012002497`*^9, 3.861873613237833*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"e84d7894-3ab9-44f4-bace-e8353fb3153e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0002823301270979972`", ",", "0.0005646602541959944`", ",", 
   "0.0005646602541959944`"}], "}"}]], "Output",
 CellChangeTimes->{3.861873616589838*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"5492b9fe-f112-44e3-a92b-3a8de46f3133"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Total", "[", 
   RowBox[{"dfun", "[", 
    RowBox[{"9.2", ",", "2", ",", "0.2", ",", "0.4"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.861873632721258*^9, 3.861873637709913*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"03910a5e-bad4-4cb0-94ce-b9d0abeeac1a"],

Cell[BoxData["0.001411650635489986`"], "Output",
 CellChangeTimes->{3.8618736403309293`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"ae37abc6-dfdc-45ef-8de1-225006ad8696"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"dfun", "[", 
    RowBox[{"9.2", ",", "2", ",", "0.2", ",", "0.4"}], "]"}], ",", 
   "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.8618737427595015`*^9, 3.8618737589495707`*^9}, {
  3.8618738840359*^9, 3.8618739092694626`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"569b4640-eeec-496e-a164-b180634f8dcc"],

Cell[BoxData["0.0014116506354899861`"], "Output",
 CellChangeTimes->{3.8618739136696944`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"03c07357-6c4d-4309-abe4-b9737ca7ae30"]
}, Open  ]],

Cell[BoxData["0.0001140248136816302`"], "Input",ExpressionUUID->"1b09133a-585b-443a-b7f8-8ccbbb1d79ed"]
},
WindowSize->{759, 833},
WindowMargins->{{Automatic, 100}, {Automatic, 128}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 280, 7, 67, "Input",ExpressionUUID->"cda7e3a5-1c44-4a33-80cd-ed9376c37470"],
Cell[841, 29, 575, 17, 28, "Input",ExpressionUUID->"2a421fa8-3e0e-4b2f-9540-1d7826ad403b"],
Cell[1419, 48, 499, 12, 28, "Input",ExpressionUUID->"10fe2c57-a59a-4d81-978b-bfede4000eaf"],
Cell[CellGroupData[{
Cell[1943, 64, 228, 4, 28, "Input",ExpressionUUID->"b72eefc6-95dc-4f58-a57d-06874eca58eb"],
Cell[2174, 70, 506, 13, 32, "Output",ExpressionUUID->"b3439cd8-93dd-4bb9-8d04-3fd7a3265112"]
}, Open  ]],
Cell[2695, 86, 735, 19, 48, "Input",ExpressionUUID->"b9532cab-c899-4472-8667-68ca616b19c5"],
Cell[3433, 107, 892, 24, 67, "Input",ExpressionUUID->"9cf3adeb-81f7-4a1e-8de7-d68cfc43500c"],
Cell[CellGroupData[{
Cell[4350, 135, 231, 4, 28, "Input",ExpressionUUID->"00c01532-6e72-41bb-9c81-8c01c01a9c53"],
Cell[4584, 141, 516, 13, 32, "Output",ExpressionUUID->"796f7df4-c36c-471b-b7d9-e6994efe9250"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5137, 159, 234, 4, 28, "Input",ExpressionUUID->"078c7367-87fd-460c-8a17-82a9c4824f41"],
Cell[5374, 165, 518, 13, 32, "Output",ExpressionUUID->"10cf7da7-775f-483b-b52c-e4efbd49150f"]
}, Open  ]],
Cell[5907, 181, 469, 12, 28, "Input",ExpressionUUID->"9da8d941-db66-4589-a7e6-077176d0d6bd"],
Cell[CellGroupData[{
Cell[6401, 197, 227, 4, 28, "Input",ExpressionUUID->"8ee07437-ce36-47f9-8659-0aa8cb7d0edb"],
Cell[6631, 203, 543, 16, 52, "Output",ExpressionUUID->"c8c95f9e-6fba-44d7-bb6b-eabdfcb94473"]
}, Open  ]],
Cell[7189, 222, 1031, 26, 48, "Input",ExpressionUUID->"d479c06d-4d6e-47ef-bd27-37aaa25e18a9"],
Cell[CellGroupData[{
Cell[8245, 252, 255, 4, 28, "Input",ExpressionUUID->"6864e6a5-bf02-44d7-971f-ec0a7c88b573"],
Cell[8503, 258, 599, 16, 52, "Output",ExpressionUUID->"a16a2ea8-264b-40fe-a548-e394c022a746"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9139, 279, 286, 5, 28, "Input",ExpressionUUID->"e84d7894-3ab9-44f4-bace-e8353fb3153e"],
Cell[9428, 286, 274, 6, 32, "Output",ExpressionUUID->"5492b9fe-f112-44e3-a92b-3a8de46f3133"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9739, 297, 321, 7, 28, "Input",ExpressionUUID->"03910a5e-bad4-4cb0-94ce-b9d0abeeac1a"],
Cell[10063, 306, 171, 2, 32, "Output",ExpressionUUID->"ae37abc6-dfdc-45ef-8de1-225006ad8696"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10271, 313, 373, 8, 28, "Input",ExpressionUUID->"569b4640-eeec-496e-a164-b180634f8dcc"],
Cell[10647, 323, 172, 2, 32, "Output",ExpressionUUID->"03c07357-6c4d-4309-abe4-b9737ca7ae30"]
}, Open  ]],
Cell[10834, 328, 103, 0, 28, "Input",ExpressionUUID->"1b09133a-585b-443a-b7f8-8ccbbb1d79ed"]
}
]
*)

(* End of internal cache information *)

