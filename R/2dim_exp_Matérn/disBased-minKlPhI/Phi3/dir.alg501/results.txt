design.opt
                   opt.weight
      10.00 0.00 0.0023310023
       9.20 2.00 0.0003330003
       8.00 0.80 0.0003330003
x.hat  9.66 1.86 0.0019980020
x.hat  8.28 0.42 0.0009990010
x.hat  8.08 0.82 0.0009990010
x.hat  9.32 2.12 0.0009990010
x.hat 10.00 0.40 0.0009990010
x.hat  8.18 0.38 0.0009990010
x.hat  9.28 2.10 0.0019980020
x.hat 10.00 0.38 0.0039960040
x.hat  8.04 0.80 0.0009990010
x.hat  9.72 2.16 0.0009990010
x.hat  9.74 0.02 0.0009990010
x.hat  8.06 0.82 0.0019980020
x.hat  8.16 0.38 0.0019980020
x.hat  9.26 2.08 0.0129870130
x.hat  9.28 2.12 0.0009990010
x.hat  9.70 0.02 0.0009990010
x.hat  7.86 0.44 0.0009990010
x.hat  9.66 1.88 0.0009990010
x.hat  8.04 0.82 0.0059940060
x.hat  9.72 0.02 0.0009990010
x.hat  9.74 0.00 0.0009990010
x.hat  9.68 1.94 0.0029970030
x.hat  8.14 0.38 0.0009990010
x.hat 10.00 0.36 0.0259740260
x.hat  9.26 2.10 0.0149850150
x.hat  9.76 0.00 0.1578421578
x.hat  8.12 0.38 0.0029970030
x.hat  8.02 0.82 0.1888111888
x.hat  9.78 0.00 0.0029970030
x.hat  9.68 1.96 0.0109890110
x.hat  8.10 0.38 0.0119880120
x.hat  9.68 1.98 0.0269730270
x.hat  8.08 0.38 0.1218781219
x.hat  9.24 2.08 0.1518481518
x.hat 10.00 0.34 0.1398601399
x.hat  9.66 1.96 0.0869130869
x.hat  9.66 1.98 0.0039960040
> nrow(design.opt)
[1] 40
> sum(design.opt[,3])
[1] 1
> plot(0:10,0:10,type="n", xlim = c(0,10), ylim = c(0,10),xlab="X1",ylab="X2",cex.main=2, cex.lab=1.5, cex.axis=1.5)
> points(design.opt[,c(1,2)], pch = 1, col = "red", cex = 20*sqrt(design.opt[,3]))
> nrow(design.opt)
[1] 40
> sum(design.opt[,3])
[1] 1

design.opt[,c(1,2)]
                
      10.00 0.00
       9.20 2.00
       8.00 0.80
x.hat  9.66 1.86
x.hat  8.28 0.42
x.hat  8.08 0.82
x.hat  9.32 2.12
x.hat 10.00 0.40
x.hat  8.18 0.38
x.hat  9.28 2.10
x.hat 10.00 0.38
x.hat  8.04 0.80
x.hat  9.72 2.16
x.hat  9.74 0.02
x.hat  8.06 0.82
x.hat  8.16 0.38
x.hat  9.26 2.08
x.hat  9.28 2.12
x.hat  9.70 0.02
x.hat  7.86 0.44
x.hat  9.66 1.88
x.hat  8.04 0.82
x.hat  9.72 0.02
x.hat  9.74 0.00
x.hat  9.68 1.94
x.hat  8.14 0.38
x.hat 10.00 0.36
x.hat  9.26 2.10
x.hat  9.76 0.00
x.hat  8.12 0.38
x.hat  8.02 0.82
x.hat  9.78 0.00
x.hat  9.68 1.96
x.hat  8.10 0.38
x.hat  9.68 1.98
x.hat  8.08 0.38
x.hat  9.24 2.08
x.hat 10.00 0.34
x.hat  9.66 1.96
x.hat  9.66 1.98
> design.opt[,3]
                                              x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat 
0.0023310023 0.0003330003 0.0003330003 0.0019980020 0.0009990010 0.0009990010 0.0009990010 0.0009990010 0.0009990010 0.0019980020 0.0039960040 
       x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat 
0.0009990010 0.0009990010 0.0009990010 0.0019980020 0.0019980020 0.0129870130 0.0009990010 0.0009990010 0.0009990010 0.0009990010 0.0059940060 
       x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat 
0.0009990010 0.0009990010 0.0029970030 0.0009990010 0.0259740260 0.0149850150 0.1578421578 0.0029970030 0.1888111888 0.0029970030 0.0109890110 
       x.hat        x.hat        x.hat        x.hat        x.hat        x.hat        x.hat 
0.0119880120 0.0269730270 0.1218781219 0.1518481518 0.1398601399 0.0869130869 0.0039960040 
> nrow(design.opt)
[1] 40
> sum(design.opt[,3])
[1] 1
> Phi.crit1 <- dir.deriv(est.theta,sigma2.ini,design.opt[,c(1,2)],design.opt[,3])
> Phi.opt1 <-  Phi.optim(est.theta,sigma2.ini,design.opt[,c(1,2)],design.opt[,3]) #equal to CRIT.vec[max.iter] 
> Phi.opt1
[1] 1.537331e-05
> Phi.check <- numeric(N)
> for(i in 1:N){
+   if(Phi.crit1[i] <= Phi.opt1){
+     Phi.check[i] <- 1
+   }else{
+     Phi.check[i] <- 0
+   }
+   
+ }
> length(which(Phi.check==0))
[1] 14
> length(which(Phi.check==0))/N
[1] 5.577667e-05

poi
       Var1 Var2
9018  10.00 0.34
9923   8.06 0.38
9924   8.08 0.38
9925   8.10 0.38
10425  8.08 0.40
10426  8.10 0.40
20942  8.00 0.82
20943  8.02 0.82
20944  8.04 0.82
21443  8.00 0.84
21444  8.02 0.84
49582  9.66 1.96
50083  9.66 1.98
52567  9.24 2.08
> 