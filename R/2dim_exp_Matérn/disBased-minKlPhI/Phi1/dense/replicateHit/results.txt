as.numeric(row.names(xstart))
  [1]  557  153  193  610  608  295  560   50  609  152   48  611  151  660  297  559  194  346  491 6081 1531  661  100 3471 5601 2461  558
 [28] 1941  294   99 3461 1511  501 5581  481  243   49 2451 6111 1521 3472 6601 2971 5591 5571 3462 1512  492  296  507 1931 2941  101 6082
 [55] 2441  991  347 6101 1532 1942  502 5081 2961 6083 6611 1522  246 5602 5582 3463  493  508 1022 2442 1513 3473  482 6102 2942 5572 1943
 [82]  503 1533 5592 2962 6602 1514 1932  992 5573 3464 6592 2431 1523  494 2452 6112  244 5583 1023 2972 6612 3465 1001 5603 6084 2453 1534
[109]  504 5593 3474  483 1515 2443 6603  102 5584   51 1944 2951 1524 6085 2462 6113 2973  495 1933 5594 1024 3475 6613 1516  245 1535 6593
[136]  505 3466 5585  993 2943 5604 1021 2454 6091  496 3476 1525 6614 5574 1945 1536 2952 5595 1002 6594 2974  512 6114 2463 2444 6086 1537
[163] 1517 3467  497 5596 6604 1934 6591 3477  506 5586  484 5605 2464 1025 2953 1518 6615  511 6087 1946  396  754  645 1223   28 1261  532
[190] 1148 1729   17 1767  984 1601  468 1437  920 2116 2232
> nrow(xstart)
[1] 200
> nrow(xstart)-n1 
[1] 196
> nleft
[1] 196
> M.COUNT[nleft,]
  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0
 [68] 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0
> M.COUNT <- M.COUNT[1:(nrow(xstart)-n1),]
> dim(M.COUNT)
[1] 196 100
> M.COUNT[nrow(xstart)-n1,]
  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0
 [68] 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0
> M.COUNT.N <- 1-M.COUNT
> M.COUNT.N[nrow(xstart)-n1,]
  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1
 [68] 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1
> av.hit.iter <- apply(M.COUNT.N,1,mean)
> av.hit.run <- apply(M.COUNT.N,2,mean)
> av.hit.iter
  [1] 0.45 0.34 0.43 0.55 0.45 0.40 0.60 0.54 0.55 0.54 0.60 0.61 0.60 0.73 0.73 0.66 0.66 0.64 0.66 0.69 0.63 0.67 0.68 0.75 0.67 0.77 0.68
 [28] 0.67 0.73 0.73 0.69 0.75 0.75 0.74 0.75 0.78 0.79 0.80 0.76 0.82 0.79 0.80 0.79 0.76 0.71 0.74 0.81 0.73 0.82 0.80 0.80 0.80 0.73 0.72
 [55] 0.84 0.75 0.88 0.82 0.86 0.86 0.86 0.82 0.84 0.83 0.85 0.89 0.80 0.89 0.88 0.84 0.82 0.86 0.87 0.85 0.91 0.89 0.85 0.87 0.86 0.85 0.86
 [82] 0.81 0.86 0.90 0.85 0.85 0.88 0.92 0.86 0.93 0.83 0.88 0.84 0.79 0.84 0.85 0.85 0.87 0.90 0.86 0.88 0.91 0.89 0.89 0.87 0.84 0.93 0.91
[109] 0.88 0.90 0.87 0.89 0.91 0.90 0.88 0.87 0.95 0.86 0.89 0.90 0.89 0.90 0.94 0.90 0.89 0.87 0.91 0.90 0.93 0.90 0.88 0.84 0.84 0.88 0.88
[136] 0.94 0.94 0.90 0.91 0.94 0.92 0.91 0.98 0.95 0.94 0.95 0.88 0.88 0.92 0.88 0.92 0.87 0.94 0.90 0.96 0.89 0.92 0.93 0.91 0.91 0.95 0.93
[163] 0.88 0.90 0.91 0.93 0.94 0.91 0.89 0.91 0.88 0.93 0.93 0.94 0.93 0.87 0.91 0.95 0.97 0.95 0.91 0.95 0.92 0.91 0.92 0.95 0.92 0.93 0.93
[190] 0.95 0.89 0.97 0.96 0.93 0.90 0.93
> av.hit.run
  [1] 0.8367347 0.8112245 0.7500000 0.8571429 0.8214286 0.8214286 0.8826531 0.8163265 0.8724490 0.8622449 0.8826531 0.7908163 0.8367347
 [14] 0.8367347 0.8418367 0.8622449 0.7908163 0.8622449 0.8265306 0.8214286 0.8163265 0.8367347 0.8316327 0.8418367 0.8214286 0.8673469
 [27] 0.8163265 0.8520408 0.8724490 0.8061224 0.8367347 0.8112245 0.8112245 0.8418367 0.8673469 0.8520408 0.8724490 0.8928571 0.8673469
 [40] 0.8214286 0.8163265 0.8418367 0.7908163 0.8163265 0.8214286 0.7806122 0.8265306 0.8265306 0.8418367 0.8418367 0.8214286 0.8316327
 [53] 0.8112245 0.8367347 0.8775510 0.8265306 0.8469388 0.8367347 0.8163265 0.8367347 0.8571429 0.8367347 0.8469388 0.8010204 0.8520408
 [66] 0.8265306 0.8520408 0.8622449 0.8265306 0.8010204 0.8265306 0.7857143 0.8265306 0.8673469 0.8367347 0.8163265 0.8469388 0.8163265
 [79] 0.8826531 0.8112245 0.8112245 0.8214286 0.8367347 0.8571429 0.8214286 0.7959184 0.8265306 0.8061224 0.8928571 0.8316327 0.8214286
 [92] 0.8877551 0.8418367 0.8010204 0.8979592 0.8010204 0.8418367 0.8673469 0.8163265 0.8724490
> dim(M.COUNT.N)
[1] 196 100
> nrow(M.COUNT.N)
[1] 196
> length(av.hit.iter)
[1] 196
> int.hit.n <- c(1,2,3,4,5,6,16,36,76,116,156,length(av.hit.iter))
> int.hit.n
 [1]   1   2   3   4   5   6  16  36  76 116 156 196
> av.hit.iter[int.hit.n]
 [1] 0.45 0.34 0.43 0.55 0.45 0.40 0.66 0.78 0.89 0.87 0.89 0.93
> int.hit.n2 <- c(1,2,3,4,5,6,16,26,36,46)
> int.hit.n2
 [1]  1  2  3  4  5  6 16 26 36 46
> av.hit.iter[int.hit.n2]
 [1] 0.45 0.34 0.43 0.55 0.45 0.40 0.66 0.77 0.78 0.74
> length(CRIT.vec)
[1] 200
> CRIT.vec <- CRIT.vec[1:nrow(xstart)]
> length(CRIT.vec)
[1] 200
> CRIT.vec
  [1] 4.335966e-06 4.335966e-06 4.335966e-06 4.335966e-06 5.266479e-01 7.774314e-01 1.078576e+00 1.423814e+00 1.816263e+00 2.264906e+00
 [11] 2.747907e+00 3.281762e+00 3.858845e+00 4.483499e+00 5.152372e+00 5.874171e+00 6.635133e+00 7.439324e+00 8.294445e+00 9.202093e+00
 [21] 1.014877e+01 1.113617e+01 1.217171e+01 1.325716e+01 1.439250e+01 1.556877e+01 1.679790e+01 1.807010e+01 1.941281e+01 2.078177e+01
 [31] 2.218825e+01 2.364518e+01 2.514340e+01 2.669038e+01 2.829868e+01 2.993931e+01 3.163016e+01 3.336887e+01 3.515980e+01 3.699077e+01
 [41] 3.887769e+01 4.079713e+01 4.276526e+01 4.478671e+01 4.684397e+01 4.895116e+01 5.110946e+01 5.331086e+01 5.554903e+01 5.784007e+01
 [51] 6.017920e+01 6.256597e+01 6.498885e+01 6.746589e+01 6.999366e+01 7.256751e+01 7.519690e+01 7.785671e+01 8.056539e+01 8.331622e+01
 [61] 8.611834e+01 8.896562e+01 9.185840e+01 9.480188e+01 9.779486e+01 1.008337e+02 1.039083e+02 1.070317e+02 1.102085e+02 1.134255e+02
 [71] 1.166898e+02 1.199962e+02 1.233549e+02 1.267558e+02 1.302126e+02 1.337084e+02 1.372485e+02 1.408456e+02 1.444860e+02 1.481685e+02
 [81] 1.518940e+02 1.556695e+02 1.594878e+02 1.633549e+02 1.672732e+02 1.712242e+02 1.752299e+02 1.792809e+02 1.833850e+02 1.875240e+02
 [91] 1.917142e+02 1.959529e+02 2.002410e+02 2.045759e+02 2.089555e+02 2.133706e+02 2.178404e+02 2.223532e+02 2.269109e+02 2.315152e+02
[101] 2.361699e+02 2.408692e+02 2.456215e+02 2.504180e+02 2.552626e+02 2.601523e+02 2.650800e+02 2.700535e+02 2.750732e+02 2.801449e+02
[111] 2.852703e+02 2.904294e+02 2.956363e+02 3.008946e+02 3.062026e+02 3.115545e+02 3.169504e+02 3.223954e+02 3.278807e+02 3.334171e+02
[121] 3.389994e+02 3.446321e+02 3.503090e+02 3.560194e+02 3.617873e+02 3.675962e+02 3.734558e+02 3.793765e+02 3.853245e+02 3.913252e+02
[131] 3.973688e+02 4.034554e+02 4.095942e+02 4.157779e+02 4.220024e+02 4.282741e+02 4.345951e+02 4.409631e+02 4.473897e+02 4.538551e+02
[141] 4.603617e+02 4.669152e+02 4.735194e+02 4.801651e+02 4.868591e+02 4.935925e+02 5.003763e+02 5.072068e+02 5.140844e+02 5.210111e+02
[151] 5.279766e+02 5.349853e+02 5.420485e+02 5.491521e+02 5.563036e+02 5.635060e+02 5.707596e+02 5.780564e+02 5.854039e+02 5.927872e+02
[161] 6.002177e+02 6.076960e+02 6.152126e+02 6.227806e+02 6.304029e+02 6.380692e+02 6.457825e+02 6.535447e+02 6.613555e+02 6.692099e+02
[171] 6.771066e+02 6.850457e+02 6.930365e+02 7.010723e+02 7.091541e+02 7.172811e+02 7.254561e+02 7.336800e+02 7.419428e+02 7.502612e+02
[181] 7.586232e+02 7.670328e+02 7.751530e+02 7.830304e+02 7.886191e+02 7.923030e+02 7.954560e+02 7.974904e+02 7.985003e+02 7.991727e+02
[191] 7.996891e+02 8.000537e+02 8.003204e+02 8.005214e+02 8.007109e+02 8.008959e+02 8.010426e+02 8.012034e+02 8.013539e+02 8.015314e+02
> xstart
     Var1 Var2
557   9.2  2.0
153  10.0  0.4
193   7.8  0.6
610   9.6  2.2
608   9.2  2.2
295   7.8  1.0
560   9.8  2.0
50    9.8  0.0
609   9.4  2.2
152   9.8  0.4
48    9.4  0.0
611   9.8  2.2
151   9.6  0.4
660   9.4  2.4
297   8.2  1.0
559   9.6  2.0
194   8.0  0.6
346   7.8  1.2
491   9.6  0.0
6081  9.2  2.2
1531 10.0  0.4
661   9.6  2.4
100   9.6  0.2
3471  8.0  1.2
5601  9.8  2.0
2461  8.2  0.8
558   9.4  2.0
1941  8.0  0.6
294   7.6  1.0
99    9.4  0.2
3461  7.8  1.2
1511  9.6  0.4
501   9.8  0.0
5581  9.4  2.0
481   9.4  0.0
243   7.6  0.8
49    9.6  0.0
2451  8.0  0.8
6111  9.8  2.2
1521  9.8  0.4
3472  8.0  1.2
6601  9.4  2.4
2971  8.2  1.0
5591  9.6  2.0
5571  9.2  2.0
3462  7.8  1.2
1512  9.6  0.4
492   9.6  0.0
296   8.0  1.0
507   9.4  1.8
1931  7.8  0.6
2941  7.6  1.0
101   9.8  0.2
6082  9.2  2.2
2441  7.8  0.8
991   9.4  0.2
347   8.0  1.2
6101  9.6  2.2
1532 10.0  0.4
1942  8.0  0.6
502   9.8  0.0
5081  9.6  1.8
2961  8.0  1.0
6083  9.2  2.2
6611  9.6  2.4
1522  9.8  0.4
246   8.2  0.8
5602  9.8  2.0
5582  9.4  2.0
3463  7.8  1.2
493   9.6  0.0
508   9.6  1.8
1022 10.0  0.2
2442  7.8  0.8
1513  9.6  0.4
3473  8.0  1.2
482   9.4  0.0
6102  9.6  2.2
2942  7.6  1.0
5572  9.2  2.0
1943  8.0  0.6
503   9.8  0.0
1533 10.0  0.4
5592  9.6  2.0
2962  8.0  1.0
6602  9.4  2.4
1514  9.6  0.4
1932  7.8  0.6
992   9.4  0.2
5573  9.2  2.0
3464  7.8  1.2
6592  9.2  2.4
2431  7.6  0.8
1523  9.8  0.4
494   9.6  0.0
2452  8.0  0.8
6112  9.8  2.2
244   7.8  0.8
5583  9.4  2.0
1023 10.0  0.2
2972  8.2  1.0
6612  9.6  2.4
3465  7.8  1.2
1001  9.6  0.2
5603  9.8  2.0
6084  9.2  2.2
2453  8.0  0.8
1534 10.0  0.4
504   9.8  0.0
5593  9.6  2.0
3474  8.0  1.2
483   9.4  0.0
1515  9.6  0.4
2443  7.8  0.8
6603  9.4  2.4
102  10.0  0.2
5584  9.4  2.0
51   10.0  0.0
1944  8.0  0.6
2951  7.8  1.0
1524  9.8  0.4
6085  9.2  2.2
2462  8.2  0.8
6113  9.8  2.2
2973  8.2  1.0
495   9.6  0.0
1933  7.8  0.6
5594  9.6  2.0
1024 10.0  0.2
3475  8.0  1.2
6613  9.6  2.4
1516  9.6  0.4
245   8.0  0.8
1535 10.0  0.4
6593  9.2  2.4
505   9.8  0.0
3466  7.8  1.2
5585  9.4  2.0
993   9.4  0.2
2943  7.6  1.0
5604  9.8  2.0
1021 10.0  0.2
2454  8.0  0.8
6091  9.4  2.2
496   9.6  0.0
3476  8.0  1.2
1525  9.8  0.4
6614  9.6  2.4
5574  9.2  2.0
1945  8.0  0.6
1536 10.0  0.4
2952  7.8  1.0
5595  9.6  2.0
1002  9.6  0.2
6594  9.2  2.4
2974  8.2  1.0
512  10.0  0.0
6114  9.8  2.2
2463  8.2  0.8
2444  7.8  0.8
6086  9.2  2.2
1537 10.0  0.4
1517  9.6  0.4
3467  7.8  1.2
497   9.6  0.0
5596  9.6  2.0
6604  9.4  2.4
1934  7.8  0.6
6591  9.2  2.4
3477  8.0  1.2
506   9.8  0.0
5586  9.4  2.0
484   9.4  0.0
5605  9.8  2.0
2464  8.2  0.8
1025 10.0  0.2
2953  7.8  1.0
1518  9.6  0.4
6615  9.6  2.4
511  10.0  0.0
6087  9.2  2.2
1946  8.0  0.6
396   7.6  1.4
754   7.8  2.8
645   6.4  2.4
1223  9.8  4.6
28    5.4  0.0
1261  7.2  4.8
532   4.2  2.0
1148  5.0  4.4
1729  9.0  6.6
17    3.2  0.0
1767  6.4  6.8
984   2.8  3.8
1601  3.8  6.2
468   1.6  1.8
1437  1.6  5.6
920   0.2  3.6
2116  4.8  8.2
2232  7.6  8.6
> #####################################################################################################
> nrow(xstart)
[1] 200
> design1.uniq <- uniquecombs(xstart)
> counter1=attr(design1.uniq,"index")
> counter2=unique(sort(counter1))
> replic1 <- replic2 <- numeric(nrow(design1.uniq))
> #----------------------------------------------------------------
> #counter <- counter2 <- numeric(length(design1.uniq))
> for(z in 1:length(counter2)){
+   x.replic <- which(counter1==counter2[z])
+   replic1[z] <- length(x.replic)
+   replic2[z] <- length(x.replic)/nrow(xstart)
+   
+ }
> design.opt <- cbind(design1.uniq,replic1,replic2)
> design.opt
     Var1 Var2 replic1 replic2
557   9.2  2.0       5   0.025
153  10.0  0.4       8   0.040
193   7.8  0.6       5   0.025
610   9.6  2.2       3   0.015
608   9.2  2.2       8   0.040
295   7.8  1.0       4   0.020
560   9.8  2.0       6   0.030
50    9.8  0.0       7   0.035
609   9.4  2.2       2   0.010
152   9.8  0.4       6   0.030
48    9.4  0.0       5   0.025
611   9.8  2.2       5   0.025
151   9.6  0.4       9   0.045
660   9.4  2.4       5   0.025
297   8.2  1.0       5   0.025
559   9.6  2.0       7   0.035
194   8.0  0.6       7   0.035
346   7.8  1.2       8   0.040
491   9.6  0.0       8   0.040
661   9.6  2.4       6   0.030
100   9.6  0.2       3   0.015
3471  8.0  1.2       8   0.040
2461  8.2  0.8       5   0.025
558   9.4  2.0       7   0.035
294   7.6  1.0       4   0.020
99    9.4  0.2       4   0.020
243   7.6  0.8       2   0.010
2451  8.0  0.8       5   0.025
296   8.0  1.0       3   0.015
507   9.4  1.8       1   0.005
101   9.8  0.2       1   0.005
2441  7.8  0.8       5   0.025
5081  9.6  1.8       2   0.010
1022 10.0  0.2       6   0.030
6592  9.2  2.4       4   0.020
51   10.0  0.0       3   0.015
396   7.6  1.4       1   0.005
754   7.8  2.8       1   0.005
645   6.4  2.4       1   0.005
1223  9.8  4.6       1   0.005
28    5.4  0.0       1   0.005
1261  7.2  4.8       1   0.005
532   4.2  2.0       1   0.005
1148  5.0  4.4       1   0.005
1729  9.0  6.6       1   0.005
17    3.2  0.0       1   0.005
1767  6.4  6.8       1   0.005
984   2.8  3.8       1   0.005
1601  3.8  6.2       1   0.005
468   1.6  1.8       1   0.005
1437  1.6  5.6       1   0.005
920   0.2  3.6       1   0.005
2116  4.8  8.2       1   0.005
2232  7.6  8.6       1   0.005
> sum(design.opt[,3])
[1] 200
> sum(design.opt[,4])
[1] 1
> 